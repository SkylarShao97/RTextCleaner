# language: r
# cache: packages

# r:
#   - release
#   - oldrel

# script:
#   - R CMD build .
#   - R CMD check *tar.gz --as-cran
language: r
r:
  - release  

cache: packages  

before_install:
  # **Debugging: Print environment information**
  - uname -a
  - lsb_release -a
  - df -h
  - sudo apt-get update --allow-releaseinfo-change -qq
  # **Clean APT cache**
  - sudo rm -rf /var/lib/apt/lists/*
  - sudo apt-get clean || true
  - sudo apt-get autoclean || true
  - sudo apt-get update --allow-releaseinfo-change -qq
  # **Install system dependencies (if needed)**
  - sudo apt-get install -y --no-install-recommends \
      libcurl4-openssl-dev \
      libssl-dev \
      libxml2-dev
  # **Install R dependencies**
  - Rscript -e 'install.packages(c("cpp11", "waldo", "gtable", "purrr"), repos="https://cloud.r-project.org")'

install:
  - Rscript -e 'install.packages("remotes", repos="https://cloud.r-project.org")'
  - Rscript -e 'remotes::install_deps(dependencies = TRUE)'

script:
  - R CMD build .
  - R CMD check *tar.gz --no-manual --as-cran